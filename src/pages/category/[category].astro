---
import Layout from '../../layouts/Layout.astro';
import ArticleCard from '../../components/ArticleCard.astro';
import { 
  getArticlesByCategorySimple, 
  getArticles, 
  categoryToSlug,
  slugToCategory,
  getPredefinedCategories,
  isPredefinedCategory 
} from '../../utils/articles-simple';

// –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç–∞—Ç–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
const PER_PAGE_OPTIONS = [6, 12, 15, 24, 30, 48];
const DEFAULT_PER_PAGE = 15;

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
function generatePageLinks(currentPage: number, totalPages: number, getPageUrl: (page: number) => string) {
  const links: Array<{type: 'page', num: number} | {type: 'dots'}> = [];
  
  if (totalPages <= 1) return links;
  
  let startPage = Math.max(1, currentPage - 2);
  let endPage = Math.min(totalPages, currentPage + 2);
  
  // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
  if (startPage > 1) {
    links.push({type: 'page', num: 1});
    if (startPage > 2) {
      links.push({type: 'dots'});
    }
  }
  
  // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  for (let i = startPage; i <= endPage; i++) {
    links.push({type: 'page', num: i});
  }
  
  // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
  if (endPage < totalPages) {
    if (endPage < totalPages - 1) {
      links.push({type: 'dots'});
    }
    links.push({type: 'page', num: totalPages});
  }
  
  return links;
}

// –î–ª—è SSR –∏—Å–ø–æ–ª—å–∑—É–µ–º getStaticPaths —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
export async function getStaticPaths() {
  const articles = await getArticles();
  const predefinedCategories = getPredefinedCategories();
  
  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Å—Ç–∞—Ç–µ–π
  const articleCategories = [...new Set(articles.map(a => a.frontmatter.category).filter(Boolean))];
  
  // –û–±—ä–µ–¥–∏–Ω—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Å—Ç–∞—Ç–µ–π –∏ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  const allCategories = [...new Set([...articleCategories, ...predefinedCategories])];
  
  return allCategories.map((category) => ({
    params: {
      category: categoryToSlug(category),
    },
  }));
}

const { category = '' } = Astro.params;

// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π URL –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
const url = new URL(Astro.request.url);
const pageParam = url.searchParams.get('page');
const perPageParam = url.searchParams.get('perPage');

// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞—Ç–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
const currentPage = pageParam ? Math.max(1, parseInt(pageParam)) : 1;
const perPage = perPageParam && PER_PAGE_OPTIONS.includes(parseInt(perPageParam)) 
  ? parseInt(perPageParam) 
  : DEFAULT_PER_PAGE;

// –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º slug –æ–±—Ä–∞—Ç–Ω–æ –≤ —á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
const categoryName = slugToCategory(category);
const allArticlesInCategory = await getArticlesByCategorySimple(category);
const totalArticles = allArticlesInCategory.length;

// –í—ã—á–∏—Å–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
const totalPages = Math.ceil(totalArticles / perPage);
const safeCurrentPage = Math.min(currentPage, Math.max(1, totalPages));
const startIndex = (safeCurrentPage - 1) * perPage;
const endIndex = startIndex + perPage;
const displayedArticles = allArticlesInCategory.slice(startIndex, endIndex);

const allArticles = await getArticles();
const allCategories = [...new Set(allArticles.map(a => a.frontmatter.category).filter(Boolean))];
const predefinedCategories = getPredefinedCategories();

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π
const isPredefined = isPredefinedCategory(category);

// –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—É—Å—Ç–∞—è –ò–õ–ò —ç—Ç–æ –Ω–µ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ò –Ω–µ—Ç —Å—Ç–∞—Ç–µ–π, —Ç–æ–≥–¥–∞ 404
if (!category || (!isPredefined && totalArticles === 0)) {
  console.log(`Redirecting to 404: category="${category}", isPredefined=${isPredefined}, articles=${totalArticles}`);
  return Astro.redirect('/404');
}

console.log(`Category: ${categoryName}, Total Articles: ${totalArticles}, Page: ${safeCurrentPage}/${totalPages}, Per Page: ${perPage}`);

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
function getPageUrl(pageNum: number, itemsPerPage?: number) {
  const params = new URLSearchParams();
  
  if (pageNum > 1) {
    params.set('page', pageNum.toString());
  }
  
  const usePerPage = itemsPerPage || perPage;
  if (usePerPage !== DEFAULT_PER_PAGE) {
    params.set('perPage', usePerPage.toString());
  }
  
  const queryString = params.toString();
  return `/category/${category}${queryString ? '?' + queryString : ''}`;
}

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Å—ã–ª–∫–∏ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
const pageLinks = generatePageLinks(safeCurrentPage, totalPages, getPageUrl);
---

<Layout 
  title={`${categoryName} - –°—Ç—Ä–∞–Ω–∏—Ü–∞ ${safeCurrentPage} –∏–∑ ${totalPages} | –ú–æ–π –±–ª–æ–≥`}
  description={`–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç—å–∏ –Ω–∞ —Ç–µ–º—É ${categoryName}. –°—Ç—Ä–∞–Ω–∏—Ü–∞ ${safeCurrentPage} –∏–∑ ${totalPages}. –í—Å–µ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –≤ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.`}
>
  <div class="container">
    <div class="category-header">
      <h1 class="category-title">{categoryName}</h1>
      <p class="category-description">
        –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç—å–∏ –Ω–∞ —Ç–µ–º—É {categoryName}. –í—Å–µ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –≤ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
      </p>
      <div class="category-count">
        <span class="count-number">{totalArticles}</span> {totalArticles === 1 ? '—Å—Ç–∞—Ç—å—è' : totalArticles < 5 ? '—Å—Ç–∞—Ç—å–∏' : '—Å—Ç–∞—Ç–µ–π'}
        {totalPages > 1 && (
          <span class="page-count"> ‚Ä¢ –°—Ç—Ä–∞–Ω–∏—Ü–∞ <strong>{safeCurrentPage}</strong> –∏–∑ <strong>{totalPages}</strong></span>
        )}
      </div>
    </div>

    {totalArticles > 0 ? (
      <>
        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="controls-panel">
          <form method="GET" action={`/category/${category}`} class="per-page-form">
            <div class="form-group">
              <label for="perPageSelect" class="form-label">–°—Ç–∞—Ç–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</label>
              <select 
                id="perPageSelect" 
                name="perPage" 
                class="per-page-select"
                onchange="this.form.submit()"
              >
                {PER_PAGE_OPTIONS.map(option => (
                  <option value={option} selected={option === perPage}>
                    {option}
                  </option>
                ))}
              </select>
            </div>
            
            <input type="hidden" name="page" value="1" />
            <button type="submit" style="display: none">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
          </form>
          
          <div class="page-stats">
            <span class="articles-range">
              –ü–æ–∫–∞–∑–∞–Ω–æ <strong>{startIndex + 1}-{Math.min(endIndex, totalArticles)}</strong> –∏–∑ <strong>{totalArticles}</strong> —Å—Ç–∞—Ç–µ–π
            </span>
          </div>
        </div>

        <!-- –°–µ—Ç–∫–∞ —Å—Ç–∞—Ç–µ–π -->
        <div class="category-articles">
          <div class="articles-grid">
            {displayedArticles.map((article) => (
              <ArticleCard article={article} />
            ))}
          </div>
        </div>

        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        {totalPages > 1 && (
          <div class="pagination">
            <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
            {safeCurrentPage > 1 && (
              <a href={getPageUrl(1)} class="pagination-btn first-page" title="–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                ¬´¬´
              </a>
            )}
            
            <!-- –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
            {safeCurrentPage > 1 && (
              <a href={getPageUrl(safeCurrentPage - 1)} class="pagination-btn prev-page" title="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                ¬´
              </a>
            )}
            
            <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü -->
            {pageLinks.map((link) => {
              if (link.type === 'dots') {
                return <span class="pagination-dots">...</span>;
              }
              
              const isActive = link.num === safeCurrentPage;
              return (
                <a 
                  href={getPageUrl(link.num)} 
                  class={`pagination-btn ${isActive ? 'active' : ''}`}
                >
                  {link.num}
                </a>
              );
            })}
            
            <!-- –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
            {safeCurrentPage < totalPages && (
              <a href={getPageUrl(safeCurrentPage + 1)} class="pagination-btn next-page" title="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                ¬ª
              </a>
            )}
            
            <!-- –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
            {safeCurrentPage < totalPages && (
              <a href={getPageUrl(totalPages)} class="pagination-btn last-page" title="–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                ¬ª¬ª
              </a>
            )}
          </div>
        )}
      </>
    ) : (
      <div class="no-articles">
        <div class="no-articles-content">
          <div class="empty-state">
            <div class="empty-icon">üì≠</div>
            <h2>–ü–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞—Ç–µ–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "{categoryName}"</h2>
            <p>–≠—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –µ—â–µ –ø—É—Å—Ç–∞, –Ω–æ –º—ã –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –Ω–æ–≤—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏. –°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Å—Ç–∞—Ç—å–∏!</p>
            
            <div class="suggestions">
              <h3>–ê –ø–æ–∫–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ:</h3>
              <div class="suggestion-cards">
                <a href="/" class="suggestion-card">
                  <span class="suggestion-icon">üè†</span>
                  <div class="suggestion-content">
                    <h4>–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h4>
                    <p>–í—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</p>
                  </div>
                </a>
                
                <a href="/about" class="suggestion-card">
                  <span class="suggestion-icon">‚ÑπÔ∏è</span>
                  <div class="suggestion-content">
                    <h4>–û —Å–∞–π—Ç–µ</h4>
                    <p>–£–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–º –±–ª–æ–≥–µ</p>
                  </div>
                </a>
              </div>
            </div>
          </div>
          
          <div class="other-categories-section">
            <h3>–î—Ä—É–≥–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å —Å—Ç–∞—Ç—å—è–º–∏:</h3>
            <div class="other-categories">
              {allCategories.filter(cat => {
                const catSlug = categoryToSlug(cat);
                return catSlug !== category;
              }).map(cat => {
                const catSlug = categoryToSlug(cat);
                return (
                  <a href={`/category/${catSlug}`} class="category-link">
                    {cat}
                  </a>
                );
              })}
            </div>
          </div>
        </div>
      </div>
    )}

    <aside class="all-categories">
      <h2>–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
      <div class="categories-list">
        {[...new Set([...allCategories, ...predefinedCategories])].map(cat => {
          const catSlug = categoryToSlug(cat);
          const isActive = catSlug === category;
          const hasArticles = allCategories.includes(cat);
          
          // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞—Ç–µ–π –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
          const articlesInCategory = allArticles.filter(
            article => article.frontmatter.category === cat
          ).length;
          
          return (
            <a 
              href={`/category/${catSlug}`} 
              class={`category-item ${isActive ? 'active' : ''} ${!hasArticles ? 'empty-category' : ''}`}
              title={!hasArticles ? '–ü–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞—Ç–µ–π' : `${articlesInCategory} ${articlesInCategory === 1 ? '—Å—Ç–∞—Ç—å—è' : articlesInCategory < 5 ? '—Å—Ç–∞—Ç—å–∏' : '—Å—Ç–∞—Ç–µ–π'}`}
            >
              <span class="category-icon">
                {cat === '–ü–æ–ª–∏—Ç–∏–∫–∞' && 'üì∞'}
                {cat === '–í –º–∏—Ä–µ' && 'üåç'}
                {cat === '–≠–∫–æ–Ω–æ–º–∏–∫–∞' && 'üí∞'}
                {cat === '–û–±—â–µ—Å—Ç–≤–æ' && 'üë•'}
                {cat === '–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è' && 'üö®'}
                {cat === '–ö—É–ª—å—Ç—É—Ä–∞' && 'üé®'}
                {cat === '–¢—É—Ä–∏–∑–º' && '‚úàÔ∏è'}
                {cat === '–ù–∞—É–∫–∞' && 'üî¨'}
                {cat === '–°–ø–æ—Ä—Ç' && '‚öΩ'}
                {!['–ü–æ–ª–∏—Ç–∏–∫–∞', '–í –º–∏—Ä–µ', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–û–±—â–µ—Å—Ç–≤–æ', '–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è', 
                   '–ö—É–ª—å—Ç—É—Ä–∞', '–¢—É—Ä–∏–∑–º', '–ù–∞—É–∫–∞', '–°–ø–æ—Ä—Ç'].includes(cat) && 'üìÑ'}
              </span>
              <span class="category-text">{cat}</span>
              <span class="category-count-badge">
                {articlesInCategory > 0 ? articlesInCategory : ''}
              </span>
              {!hasArticles && <span class="empty-badge">–ø—É—Å—Ç–æ</span>}
            </a>
          );
        })}
      </div>
    </aside>
  </div>
</Layout>

<style>
.category-header {
  text-align: center;
  padding: 3rem 1rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 12px;
  margin-bottom: 2rem;
}

.category-title {
  font-size: 2.5rem;
  margin: 0 0 1rem 0;
}

.category-description {
  font-size: 1.1rem;
  opacity: 0.9;
  max-width: 600px;
  margin: 0 auto 1.5rem;
}

.category-count {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  background: rgba(255, 255, 255, 0.2);
  padding: 0.5rem 1.5rem;
  border-radius: 20px;
  font-size: 0.9rem;
  flex-wrap: wrap;
  justify-content: center;
}

.count-number {
  font-weight: bold;
  font-size: 1.2rem;
}

.page-count {
  margin-left: 0.5rem;
  padding-left: 0.5rem;
  border-left: 1px solid rgba(255, 255, 255, 0.3);
}

/* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
.controls-panel {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1.5rem;
  background: #f8f9fa;
  border-radius: 12px;
  margin-bottom: 2rem;
  flex-wrap: wrap;
  gap: 1.5rem;
  border: 1px solid #e9ecef;
}

.per-page-form {
  display: flex;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.form-group {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.form-label {
  font-weight: 600;
  color: #555;
  font-size: 0.95rem;
  white-space: nowrap;
}

.per-page-select {
  padding: 0.6rem 1.2rem;
  border: 2px solid #ddd;
  border-radius: 8px;
  background: white;
  color: #333;
  font-size: 0.95rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s;
  min-width: 80px;
}

.per-page-select:hover {
  border-color: #667eea;
  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
}

.per-page-select:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
}

.page-stats {
  font-size: 0.95rem;
  color: #666;
  background: white;
  padding: 0.6rem 1.2rem;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

.articles-range strong {
  color: #333;
  font-weight: 600;
}

.articles-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(600px, 1fr));
  gap: 2rem;
  margin: 2rem 0;
}

/* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */
.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin: 3rem 0;
  padding: 1rem;
  flex-wrap: wrap;
}

.pagination-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  height: 40px;
  padding: 0 0.75rem;
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  color: #555;
  text-decoration: none;
  font-size: 0.9rem;
  font-weight: 500;
  transition: all 0.3s;
  cursor: pointer;
}

.pagination-btn:hover {
  background: #667eea;
  color: white;
  border-color: #667eea;
  transform: translateY(-2px);
}

.pagination-btn.active {
  background: #667eea;
  color: white;
  border-color: #667eea;
}

.pagination-dots {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  height: 40px;
  color: #999;
  font-size: 1.2rem;
}

.first-page, .last-page {
  font-weight: bold;
}

.prev-page, .next-page {
  min-width: 50px;
}

.no-articles {
  padding: 4rem 2rem;
  background: #f8f9fa;
  border-radius: 12px;
  margin: 2rem 0;
  border: 2px dashed #ddd;
}

.empty-state {
  text-align: center;
  max-width: 800px;
  margin: 0 auto;
}

.empty-icon {
  font-size: 4rem;
  margin-bottom: 1.5rem;
  opacity: 0.5;
}

.empty-state h2 {
  color: #555;
  margin-bottom: 1rem;
  font-size: 1.8rem;
}

.empty-state p {
  color: #777;
  font-size: 1.1rem;
  line-height: 1.6;
  margin-bottom: 2rem;
}

.suggestions {
  margin: 3rem 0;
  padding-top: 2rem;
  border-top: 1px solid #eee;
}

.suggestions h3 {
  color: #555;
  margin-bottom: 1.5rem;
  font-size: 1.3rem;
}

.suggestion-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  max-width: 600px;
  margin: 0 auto;
}

.suggestion-card {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1.5rem;
  background: white;
  border-radius: 12px;
  text-decoration: none;
  color: #333;
  border: 1px solid #e9ecef;
  transition: all 0.3s;
}

.suggestion-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  border-color: #667eea;
}

.suggestion-icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.suggestion-content h4 {
  margin: 0 0 0.5rem 0;
  font-size: 1.1rem;
  color: #333;
}

.suggestion-content p {
  margin: 0;
  color: #666;
  font-size: 0.9rem;
}

.other-categories-section {
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid #eee;
}

.other-categories-section h3 {
  color: #555;
  margin-bottom: 1.5rem;
  text-align: center;
  font-size: 1.3rem;
}

.other-categories {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
  max-width: 800px;
  margin: 0 auto;
}

.category-link {
  background: #667eea;
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  text-decoration: none;
  font-size: 0.9rem;
  transition: all 0.3s;
}

.category-link:hover {
  background: #5a67d8;
  transform: translateY(-2px);
}

.all-categories {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 2px 20px rgba(0,0,0,0.1);
  margin: 3rem 0;
}

.all-categories h2 {
  margin: 0 0 1.5rem 0;
  color: #333;
}

.categories-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
}

.category-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 8px;
  text-decoration: none;
  color: #555;
  transition: all 0.3s;
  position: relative;
  justify-content: space-between;
}

.category-item:hover {
  background: #667eea;
  color: white;
  transform: translateY(-2px);
}

.category-item.active {
  background: #667eea;
  color: white;
}

.category-item.empty-category {
  opacity: 0.7;
  color: #555;
  background: #f0f0f0;
}

.category-item.empty-category.active {
  color: #555;
}

.category-icon {
  font-size: 1.2rem;
}

.category-text {
  font-weight: 500;
  flex: 1;
}

.category-count-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 24px;
  background: rgba(102, 126, 234, 0.1);
  color: #667eea;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: bold;
  margin-left: 0.5rem;
  padding: 0 0.5rem;
}

.category-item.active .category-count-badge {
  background: rgba(255, 255, 255, 0.3);
  color: white;
}

.category-item.empty-category .category-count-badge {
  display: none;
}

.empty-badge {
  background: rgba(0,0,0,0.1);
  color: #666;
  padding: 0.2rem 0.5rem;
  border-radius: 10px;
  font-size: 0.7rem;
  font-weight: normal;
}

.category-item.active .empty-badge {
  background: rgba(255,255,255,0.3);
  color: white;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
  .category-title {
    font-size: 2rem;
  }
  
  .articles-grid {
    grid-template-columns: 1fr;
  }
  
  .categories-list {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  }
  
  .suggestion-cards {
    grid-template-columns: 1fr;
  }
  
  .empty-icon {
    font-size: 3rem;
  }
  
  .empty-state h2 {
    font-size: 1.5rem;
  }
  
  .category-item {
    padding: 0.75rem;
    gap: 0.5rem;
  }
  
  .category-count-badge {
    min-width: 20px;
    height: 20px;
    font-size: 0.7rem;
    margin-left: 0.25rem;
  }
  
  .controls-panel {
    flex-direction: column;
    align-items: stretch;
    gap: 1rem;
  }
  
  .per-page-form {
    width: 100%;
    justify-content: space-between;
  }
  
  .form-group {
    width: 100%;
    justify-content: space-between;
  }
  
  .page-stats {
    width: 100%;
    text-align: center;
  }
  
  .pagination {
    gap: 0.25rem;
  }
  
  .pagination-btn {
    min-width: 35px;
    height: 35px;
    padding: 0 0.5rem;
    font-size: 0.85rem;
  }
  
  .pagination-dots {
    min-width: 35px;
    height: 35px;
  }
}

@media (max-width: 480px) {
  .articles-grid {
    grid-template-columns: 1fr;
  }
  
  .category-header {
    padding: 2rem 1rem;
  }
  
  .category-title {
    font-size: 1.8rem;
  }
  
  .category-count {
    font-size: 0.85rem;
    padding: 0.4rem 1rem;
  }
  
  .per-page-select {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
  }
  
  .form-label {
    font-size: 0.9rem;
  }
}
</style>

<script>
// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç–∞—Ç–µ–π —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ localStorage
document.addEventListener('DOMContentLoaded', () => {
  const perPageSelect = document.getElementById('perPageSelect') as HTMLSelectElement;
  
  if (perPageSelect) {
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ localStorage
    const savedPerPage = localStorage.getItem('articlesPerPage');
    if (savedPerPage) {
      const option = perPageSelect.querySelector(`option[value="${savedPerPage}"]`) as HTMLOptionElement;
      if (option) {
        perPageSelect.value = savedPerPage;
      }
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ localStorage –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    perPageSelect.addEventListener('change', function() {
      localStorage.setItem('articlesPerPage', this.value);
    });
  }
});
</script>